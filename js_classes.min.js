/**
 * Michael Crowe (crowebird - www.crowebird.com) - 2013
 * https://github.com/crowebird/js_classes
 */
(function(e){"use strict";var t={};e.js_classes=function(){};var n=function(){if(arguments.length>3||arguments.length==0)throw{name:"Error",message:"Invalid class declaration, invalid number of arguments"};var r=arguments[0];if(typeof r!="string"||!/^[$_A-Z][$_A-Z0-9]*?(?:[\.][$_A-Z][$_A-Z0-9]*?)*?$/i.test(r))throw{name:"Error",message:"Invalid class name, must be a string that represents a valid variable name that will be used as the class name"};var i=r.split(/\./),s=arguments[arguments.length==3?2:1];if(typeof s!="function")throw{name:"Error",message:"Invalid class function, a js_classes class can only be created by wrapping a function"};var o=arguments.length==3?arguments[1]:!1;if(o!==!1&&typeof o!="object")throw{name:"Error",message:"Invalid class Auto-Instantiate parameter, expecting an Object"};var u=e;for(var a=0;a<i.length;++a){if(!u[i[a]])break;if(a==i.length-1){if(u[i[a]]&&u[i[a]].js_classes&&u[i[a]].js_classes.IDENT==js_classes.IDENT)throw{name:"Error",message:"Cannot redeclare class "+r}}else u=u[i[a]]}var f=this,l=!1;s.name=="abstract"&&(l=!0);var c=function(t){if(t!==js_classes.PREVENTCONSTRUCT&&l)throw{name:"Error",message:"You cannot create an instance of abstract class "+r};var n=[],i=new s,o=null;if(f!==e.js_classes){o=new f(js_classes.PREVENTCONSTRUCT);for(var u in o)o.hasOwnProperty(u)&&(i[u]?i[u]=function(e,t,n,i){if(typeof t!=typeof n)throw{name:"Error",message:"Class "+r+" cannot override "+e+" of type "+typeof n+" with type "+typeof t};if(typeof t=="function"){if(n.abstract&&n.definedArguments!=t.length)throw{name:"Error",message:"Declaration of "+r+"::"+u+" must be compatible with "+n.className+"::"+e};return function(){return t.apply({_super:i},arguments)}}return t}(u,i[u],o[u],o):i[u]=function(e,t){return t.abstract&&n.push(e),t}(u,o[u]))}for(var u in i)i.hasOwnProperty(u)&&typeof i[u]=="function"&&(o==null||o!=null&&!o[u])&&(i[u]=function(e,t,i){if(t.name=="abstract"){n.push(e);var s=String(t);s=s.replace(/(?:\/\*(?:[\s\S]*?)\*\/)|(?:[\s;]+\/\/(?:.*)$)/gm,"");if(!/^function abstract\(.*?\)\s*?{\s*?\}/m.test(String(s)))throw{name:"Error",message:"Abstract function "+r+"::"+u+" cannot contain a body"}}var a=function(){return t.apply(o?{_super:i}:null,arguments)};return a.abstract=t.name=="abstract",a.definedArguments=t.length,a.className=r,a}(u,i[u],o));if(!l&&n.length>0)throw{name:"Error",message:"Class "+r+" contains "+n.length+" abstract method"+(n.length==1?"":"s")+" and must be declared abstract or have those methods implemented ("+n.reverse().toString()+")"};var a=this;return i._instanceOf=function(e){return e===js_classes||a instanceof e||o&&o._instanceOf&&o._instanceOf(e)?!0:!1},i._construct&&t!==js_classes.PREVENTCONSTRUCT&&(i._construct.apply(null,arguments),delete i._construct),i};u=e;for(a=0;a<i.length;++a){u[i[a]]||(u[i[a]]={});if(a==i.length-1){for(var h in u[i[a]])u[i[a]].hasOwnProperty(h)&&(c[h]=u[i[a]][h]);u[i[a]]=c}else u=u[i[a]]}c.extend=n,c.js_classes={CREATED:new Date,IDENT:js_classes.IDENT};if(o){if(l)throw{name:"Error",message:"You cannot create an instance of abstract class "+r};var p=new c(js_classes.PREVENTCONSTRUCT);return p._construct&&(p._construct.apply(null,o),delete p._construct),t[r]=p,p}};js_classes.extend=n,js_classes.instances=function(e){return t[e]?t[e]:!1},js_classes.PREVENTCONSTRUCT="ED7352BC-BDDD-45BA-B0B5-3577A355665A-05A4367A-7CD1-4B54-91B0-F2DA44D4871A",js_classes.IDENT="6931988F-786C-48A0-8A45-7C2D8A05A766DEAC069B-C752-4669-B956-E6D24DF3B87A"})(window)
